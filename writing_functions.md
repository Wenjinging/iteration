writing_functions
================
2022-11-05

## Z scores!!

Let’s compute the z-scores version of a list of numbers.

``` r
x_vec = rnorm(25,mean =7,sd=4)

(x_vec-mean(x_vec))/(sd(x_vec))
```

    ##  [1] -1.46656550  2.29119922  0.85677298 -0.46202643 -0.47629097  1.11316630
    ##  [7] -0.73705507 -0.49746964 -0.36996111  0.61234025  0.39432636 -1.09317314
    ## [13]  0.18518054  1.71363849  0.06760036  0.89082339 -1.47411045 -1.85294210
    ## [19]  1.09593823 -0.06539493 -0.27279114 -0.61085959  0.51728417 -0.47344755
    ## [25]  0.11381736

Suppose you want to do this often.

``` r
z_scores = function(x){
  
  if(!is.numeric(x)){
    stop("Z scores only work for numbers")
  }
  
  if(length(x)<3){
    stop("Z scores really only work if you have thee or more numbers")
  }
  
  z = (x-mean(x))/(sd(x))
  
  z
}
```

``` r
z_scores(x_vec)
```

    ##  [1] -1.46656550  2.29119922  0.85677298 -0.46202643 -0.47629097  1.11316630
    ##  [7] -0.73705507 -0.49746964 -0.36996111  0.61234025  0.39432636 -1.09317314
    ## [13]  0.18518054  1.71363849  0.06760036  0.89082339 -1.47411045 -1.85294210
    ## [19]  1.09593823 -0.06539493 -0.27279114 -0.61085959  0.51728417 -0.47344755
    ## [25]  0.11381736

``` r
z_scores(x=1:10)
```

    ##  [1] -1.4863011 -1.1560120 -0.8257228 -0.4954337 -0.1651446  0.1651446
    ##  [7]  0.4954337  0.8257228  1.1560120  1.4863011

``` r
z_scores(x=rbinom(1000,1,.6))
```

    ##    [1]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##    [8] -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160 -1.257933
    ##   [15] -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933  0.794160
    ##   [22]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933  0.794160
    ##   [29]  0.794160  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160
    ##   [36] -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933 -1.257933
    ##   [43]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##   [50] -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933
    ##   [57]  0.794160  0.794160  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##   [64] -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160
    ##   [71] -1.257933  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160
    ##   [78]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##   [85]  0.794160 -1.257933  0.794160 -1.257933 -1.257933 -1.257933  0.794160
    ##   [92] -1.257933 -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##   [99]  0.794160  0.794160 -1.257933  0.794160 -1.257933  0.794160  0.794160
    ##  [106]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [113]  0.794160 -1.257933  0.794160  0.794160 -1.257933  0.794160 -1.257933
    ##  [120]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [127]  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [134]  0.794160  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [141] -1.257933  0.794160 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [148]  0.794160 -1.257933  0.794160 -1.257933 -1.257933  0.794160 -1.257933
    ##  [155] -1.257933  0.794160 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [162]  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [169] -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [176] -1.257933  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [183]  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933 -1.257933
    ##  [190] -1.257933  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160
    ##  [197] -1.257933 -1.257933  0.794160 -1.257933  0.794160  0.794160 -1.257933
    ##  [204]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [211]  0.794160 -1.257933 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [218]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [225]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [232]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [239]  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160  0.794160
    ##  [246] -1.257933  0.794160  0.794160 -1.257933 -1.257933 -1.257933  0.794160
    ##  [253]  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [260] -1.257933  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [267] -1.257933  0.794160  0.794160 -1.257933 -1.257933 -1.257933 -1.257933
    ##  [274]  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [281] -1.257933 -1.257933  0.794160  0.794160 -1.257933 -1.257933 -1.257933
    ##  [288] -1.257933  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [295] -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933 -1.257933
    ##  [302] -1.257933  0.794160 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [309]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [316] -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160 -1.257933
    ##  [323] -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [330]  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [337] -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [344] -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [351]  0.794160 -1.257933  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [358]  0.794160 -1.257933 -1.257933 -1.257933  0.794160 -1.257933 -1.257933
    ##  [365]  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [372]  0.794160 -1.257933 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [379] -1.257933  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [386] -1.257933 -1.257933  0.794160  0.794160  0.794160 -1.257933 -1.257933
    ##  [393] -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [400]  0.794160 -1.257933 -1.257933 -1.257933 -1.257933 -1.257933  0.794160
    ##  [407]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [414]  0.794160 -1.257933  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [421]  0.794160 -1.257933  0.794160  0.794160 -1.257933  0.794160 -1.257933
    ##  [428]  0.794160  0.794160  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [435] -1.257933  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [442] -1.257933 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [449]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [456] -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933
    ##  [463]  0.794160 -1.257933 -1.257933 -1.257933  0.794160 -1.257933  0.794160
    ##  [470] -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160
    ##  [477] -1.257933 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [484]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##  [491]  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160
    ##  [498]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [505]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [512]  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [519] -1.257933  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [526]  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [533]  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933
    ##  [540] -1.257933  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [547]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [554] -1.257933  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933
    ##  [561]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [568]  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [575] -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160
    ##  [582]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##  [589]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [596]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160 -1.257933
    ##  [603]  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [610] -1.257933  0.794160 -1.257933 -1.257933  0.794160 -1.257933  0.794160
    ##  [617] -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [624]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [631]  0.794160  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [638]  0.794160 -1.257933 -1.257933 -1.257933 -1.257933 -1.257933  0.794160
    ##  [645] -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##  [652]  0.794160 -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933
    ##  [659] -1.257933 -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [666]  0.794160 -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [673] -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [680]  0.794160 -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [687] -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160 -1.257933
    ##  [694]  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160
    ##  [701] -1.257933  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933
    ##  [708] -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [715]  0.794160  0.794160 -1.257933 -1.257933  0.794160 -1.257933 -1.257933
    ##  [722] -1.257933 -1.257933 -1.257933  0.794160  0.794160 -1.257933  0.794160
    ##  [729] -1.257933 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [736]  0.794160  0.794160  0.794160 -1.257933  0.794160 -1.257933 -1.257933
    ##  [743] -1.257933 -1.257933  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [750] -1.257933 -1.257933 -1.257933  0.794160 -1.257933  0.794160  0.794160
    ##  [757]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [764] -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [771]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [778]  0.794160  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [785]  0.794160 -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [792] -1.257933 -1.257933 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [799]  0.794160 -1.257933  0.794160 -1.257933 -1.257933  0.794160  0.794160
    ##  [806] -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [813] -1.257933 -1.257933  0.794160  0.794160 -1.257933 -1.257933  0.794160
    ##  [820]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [827]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160
    ##  [834]  0.794160  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [841]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [848] -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [855]  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [862]  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [869] -1.257933 -1.257933  0.794160  0.794160  0.794160 -1.257933 -1.257933
    ##  [876] -1.257933  0.794160 -1.257933 -1.257933 -1.257933  0.794160  0.794160
    ##  [883] -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933 -1.257933
    ##  [890]  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160  0.794160
    ##  [897] -1.257933 -1.257933 -1.257933  0.794160  0.794160  0.794160  0.794160
    ##  [904] -1.257933 -1.257933  0.794160 -1.257933  0.794160 -1.257933  0.794160
    ##  [911]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [918]  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160  0.794160
    ##  [925]  0.794160 -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [932] -1.257933 -1.257933 -1.257933  0.794160  0.794160  0.794160 -1.257933
    ##  [939] -1.257933  0.794160  0.794160  0.794160  0.794160 -1.257933  0.794160
    ##  [946] -1.257933  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [953]  0.794160  0.794160  0.794160 -1.257933 -1.257933  0.794160  0.794160
    ##  [960] -1.257933  0.794160 -1.257933 -1.257933 -1.257933 -1.257933 -1.257933
    ##  [967]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [974]  0.794160 -1.257933  0.794160  0.794160 -1.257933  0.794160  0.794160
    ##  [981]  0.794160  0.794160  0.794160 -1.257933  0.794160  0.794160  0.794160
    ##  [988] -1.257933  0.794160  0.794160 -1.257933  0.794160 -1.257933 -1.257933
    ##  [995]  0.794160  0.794160 -1.257933  0.794160  0.794160 -1.257933

``` r
#z_scores(x=3)
#z_scores("my name is Wenjing Yang")
```

## let’s have multiple outputs

let’s just get the mean and sd from the vector output.

``` r
mean_and_sd = function(x){

  if(!is.numeric(x)){
    stop("Z scores only work for numbers")
  }
  
  if(length(x)<3){
    stop("Z scores really only work if you have thee or more numbers")
  }
  
  mean_x = mean(x)
  sd_x = sd(x)
  
  tibble(
    mean = mean_x,
    sd = sd_x
  )
}
```

``` r
mean_and_sd(x_vec)
```

    ## # A tibble: 1 × 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  7.09  4.42

``` r
mean_and_sd(1:10)
```

    ## # A tibble: 1 × 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1   5.5  3.03

``` r
mean_and_sd(rbinom(1000,1,.5))
```

    ## # A tibble: 1 × 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1 0.526 0.500

## let’s start with simulation…

``` r
x_vec = rnorm(25,mean =7,sd=4)

  
tibble(
    mean = mean(x_vec),
    sd = sd(x_vec)
  )
```

    ## # A tibble: 1 × 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  7.62  3.98

Can I do this using function? Yup

``` r
sim_mean_sd = function(n_obs, true_mean = 7, true_sd = 4){
  
  x = rnorm(n=n_obs,mean =true_mean,sd=true_sd)

  
tibble(
    mean = mean(x),
    sd = sd(x)
  )
}
```

Does it work?

``` r
sim_mean_sd(2500,10,3)
```

    ## # A tibble: 1 × 2
    ##    mean    sd
    ##   <dbl> <dbl>
    ## 1  9.96  2.95

## Fixing bad stuff

``` r
url = "https://www.amazon.com/product-reviews/B00005JNBQ/ref=cm_cr_arp_d_viewopt_rvwer?ie=UTF8&reviewerType=avp_only_reviews&sortBy=recent&pageNumber=1"

dynamite_html = read_html(url)

review_titles = 
  dynamite_html %>%
  html_nodes(".a-text-bold span") %>%
  html_text()

review_stars = 
  dynamite_html %>%
  html_nodes("#cm_cr-review_list .review-rating") %>%
  html_text() %>%
  str_extract("^\\d") %>%
  as.numeric()

review_text = 
  dynamite_html %>%
  html_nodes(".review-text-content span") %>%
  html_text() %>% 
  str_replace_all("\n", "") %>% 
  str_trim()

reviews = tibble(
  title = review_titles,
  stars = review_stars,
  text = review_text
)
```
